# 目標管理アプリ 仕様書（MVP版）

## 1. 画面構成

- **タブ**：Home / Goals
- **Home**：
  - 上部20%にキャラ帯（キャラクター＋数値サマリ）
  - TODOリスト：セクション（今日 / 明日 / 今週 / 期限なし）
  - クイック追加バー
- **Goals**：
  - 夢カード → 長期カード → 短期詳細（配下TODO）

---

## 2. 並び替え・表示ルール

- **セクション順**：今日 → 明日 → 今週 → 期限なし
- **並び順（セクション内）**：Pinned > 優先度(3→0) > 期限(早→遅→なし) > 作成日(古→新)
- **既定表示**：未完了のみ（完了はトグルで切替）

---

## 3. TODO属性

- title（必須）
- priority（0〜3、既定=1）
- due（任意、今日/明日/週末/来週/日付指定/なし）
- shortTermId（任意、紐付け）
- archived（falseが既定）
- status（todo/done、既定=todo）
- doneAt（完了時）
- createdAt / updatedAt

---

## 4. 入力・編集フロー

- クイック追加：タイトル入力のみ
- 追加後：インラインで優先度・期限・紐付けを付与
- 大量入力：連続追加モード（Home内に統合）

---

## 5. 紐付けルール

- 一本鎖：TODO → 短期 → 長期 → 夢
- 紐付けは短期単位で行う（長期・夢は導出）

---

## 6. キャラ帯（20%）

- **表示**：
  - キャラクター
  - 距離 km（1TODO=1km固定）
  - エリア名（森→砂漠→都市→海→ゴールの5段階）
  - 完了数：今週 / 今月 / 累計
- **アニメーション**：
  - 完了時：キャラが数歩進む（0.5〜1秒）
  - エリア切替時のみ小演出
- **設定**：演出ON/OFF（既定=ON）

---

## 7. Goals画面

- **夢カード**：タイトル＋直近30日の完了数
- **長期カード**：タイトル＋累計完了数 / 未完了数
- **短期詳細**：
  - 紐付いたTODO表示（未完了上位 / 完了は折りたたみ下）
  - CRUD可能

---

## 8. 永続化・アーキテクチャ

- DB：Isar（ローカル保存）
- 状態管理：hooks\_riverpod
- ルーティング：go\_router
- 通知：MVPでは無し（スヌーズ＝日付変更のみ）

---

## 9. 時間・集計定義

- 「今日/今週/今月」＝端末ローカル時間（Asia/Tokyo）
- 週の開始：月曜（既定）
- 今週/今月/累計＝Task.doneAtベースでカウント

---

## 10. アクセプタンス基準（DoD）

- Home：
  - クイック追加 → 属性付与 → 完了 → カウント反映（即時）
  - セクション別表示＆並び順が仕様どおり
  - トグルで完了表示切替可能
- Goals：
  - 夢/長期/短期のCRUD & アーカイブ
  - カード右肩の数値が即時更新
  - 短期詳細で配下TODOのCRUD可能
- キャラ帯：
  - 完了1件で距離+1km、今週/今月/累計更新
  - エリア切替で背景変化
- 永続化：
  - アプリ再起動後もデータ保持

---

## 11. モデル定義（Isar想定）

```dart
Dream { id, title, color, archived, createdAt, updatedAt }
LongTerm { id, title, dreamId?, archived, createdAt, updatedAt }
ShortTerm { id, title, longTermId?, archived, createdAt, updatedAt }
Task {
  id, title, priority=1, due?, shortTermId?, archived=false,
  status='todo', doneAt?, createdAt, updatedAt
}
```

---

## 12. UIトーン（日本向け）

- 優先度：低/中/高/最優先（ドット色で区別）
- 期限チップ：今日 / 明日 / 週末 / 来週 / 日付指定 / なし
- 空状態：
  - Home「今日のTODOはありません」
  - Goals「まだ目標がありません」

---

## 13. 設定項目

- 週の開始：月曜/日曜（既定=月曜）
- キャラ演出：ON/OFF（既定=ON）
- データエクスポート：JSON（任意、後回し可）

---
